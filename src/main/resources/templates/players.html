<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DataTable with Ajax</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" type="text/css"
          href="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
          href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.0/dist/lux/bootstrap.min.css">
</head>
<body>
<div class="container mt-4">
    <div class="card">
        <div class="card-body">
            <table id="example" class="table table-striped table-bordered" style="width:100%">
                <thead>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Age</th>
                    <th>Nationality</th>
                    <th>Team</th>
                    <th>Delete</th>
                </tr>
                </thead>
            </table>
        </div>
    </div>
    <div class="mt-3">
        <button id="addPlayerButton" class="btn btn-primary">Add Player</button>
        <button id="homeButton" class="btn btn-primary">Home</button>
    </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.25/js/dataTables.bootstrap5.min.js"></script>
<script>
$(document).ready(function() {
    var dataTable = $('#example').DataTable({
        "ajax": {
            "url": "http://localhost:8080/players/all",
            "dataSrc": ""
        },
        "columns": [
            { "data": "id" },
            { "data": "name" },
            { "data": "age" },
            { "data": "nationality" },
            { "data": "team.name", "render": function(data, type, row) { return data ? data : ""; } },
            {
                "data": null,
                "render": function(data, type, row) {
                    return '<button class="btn btn-danger deleteButton" data-id="' + row.id + '">Delete</button>';
                }
            }
        ]
    });

    // Handle delete button click event
    $('#example').on('click', '.deleteButton', function() {
        var playerId = $(this).data('id');
        var deleteUrl = "http://localhost:8080/players/delete/" + playerId;

        // Perform the delete request
        $.ajax({
            url: deleteUrl,
            type: 'DELETE',
            success: function() {
                // Refresh the DataTable
                dataTable.ajax.reload();
            },
            error: function() {
                alert('Error deleting the player.');
            }
        });
    });

    $('#addPlayerButton').on('click', function() {
        window.location.href = "add-player";
    });

    $('#homeButton').on('click', function() {
        window.location.href = "home";
    });
});
</script>
</body>
</html>
